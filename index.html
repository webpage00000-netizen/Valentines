<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Surprise</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  * { margin:0; padding:0; box-sizing:border-box; }
  #loadingScreen {
    position: fixed; inset: 0;
    background: #f9fafc;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    z-index: 9999;
    font-family: 'Montserrat', sans-serif;
    overflow: hidden;
    transition: opacity 0.8s ease;
  }
  .cat-wrapper {
    padding: 12px; border-radius: 22px;
    background: white; box-shadow: 0 10px 25px rgba(0,0,0,0.06);
    margin-bottom: 20px;
  }
  .cat {
    width: 170px; max-width: 60vw;
    border-radius: 18px; border: 1.5px solid #ffd6e8;
  }
  .loading-text { font-size: 18px; color: #666; }
  .countdown {
    font-size: 55px; font-weight: 700;
    color: #ff6fa5; margin-top: 15px;
    opacity: 0; transition: 0.4s;
  }
  .show { opacity: 1; transform: scale(1.1); }
  .heart {
    position: absolute;
    font-size: 30px;
    animation: float-up 2s ease-out forwards;
    pointer-events: none;
  }
  @keyframes float-up {
    0% {
      transform: translateY(0) scale(0);
      opacity: 1;
    }
    50% {
      opacity: 1;
    }
    100% {
      transform: translateY(-100vh) scale(1.5);
      opacity: 0;
    }
  }
  body {
    font-family: 'Montserrat', sans-serif;
    background: linear-gradient(135deg, #ffe6e6, #fff0f5);
    display: flex; flex-direction: column; align-items: center;
    padding: 20px; min-height: 100vh;
  }
  .container {
    display: flex; flex-direction: column; align-items: center;
    justify-content: center;
    width: 100%; max-width: 450px;
    min-height: 100vh;
    transition: 1.5s ease;
  }
  h1 {
    font-family: 'Fredoka One', cursive;
    color: #d60000; font-size: clamp(1.5em, 5vw, 2em);
    text-align: center; margin-bottom: 20px;
    overflow: hidden;
    white-space: nowrap;
    width: 0;
    animation: typing 2s steps(30) forwards;
  }
  @keyframes typing {
    from { width: 0; }
    to { width: 100%; }
  }
  .input-boxes { display: flex; gap: 10px; margin-bottom: 15px; }
  .box {
    width: clamp(50px, 15vw, 60px); 
    height: clamp(50px, 15vw, 60px);
    border: 3px solid #d60000; border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: clamp(20px, 6vw, 24px); font-weight: bold;
    background: #fff; color: #fff;
  }
  .keyboard { display: flex; flex-direction: column; gap: 10px; width: 100%; transition: all 0.7s ease; }
  .keyboard.hidden { 
    opacity: 0; 
    pointer-events: none; 
    max-height: 0;
    overflow: hidden;
    margin: 0;
  }
  h1, .input-boxes {
    transition: all 0.7s ease;
  }
  #marqueeBanner {
    position: fixed;
    top: 30px;
    left: 0;
    right: 0;
    background: #000;
    color: white;
    padding: 8px 0;
    border-radius: 0;
    overflow: hidden;
    z-index: 9999;
    display: none;
    transition: opacity 0.3s ease;
  }
  #marqueeText {
    display: flex;
    white-space: nowrap;
    animation: marqueeScroll 20s linear infinite;
  }
  #marqueeText span {
    font-size: 13px;
    font-weight: 600;
    letter-spacing: 1px;
  }
  @keyframes marqueeScroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }
  .row { display: flex; justify-content: center; gap: 5px; }
  .key {
    flex: 1; height: 50px;
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    background: #ccc; color: white; font-weight: bold;
    cursor: not-allowed; transition: 0.2s;
  }
  .key.highlight { background: #d60000; cursor: pointer; }
  .key.highlight:hover { transform: scale(1.1); }
  .key.special { background: #ff6600; cursor: pointer; }
  .key.special:hover { transform: scale(1.1); }
  #message { margin-top: 10px; font-size: clamp(16px, 4.5vw, 20px); color: #d60000; font-weight: 600; text-align: center; }
  #shortMessage { margin-top: 10px; font-size: clamp(14px, 4vw, 16px); color: #333; text-align: center; display: none; }
  #loading { font-size: clamp(16px, 4vw, 18px); margin-top: 10px; display: none; text-align: center; }
  .dot { animation: blink 1s infinite; }
  .dot:nth-child(2) { animation-delay: 0.2s; }
  .dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes blink { 0%,50%,100% { opacity: 0; } 25%,75% { opacity: 1; } }
  #proceedBtn {
    margin-top: 20px; padding: 10px 20px;
    font-size: clamp(16px, 4vw, 18px); background: #d60000; color: white;
    border: none; border-radius: 10px; cursor: pointer;
    display: none; transition: 0.2s;
  }
  #proceedBtn:hover { background: #ff1a1a; transform: scale(1.05); }
  #puzzleContainer { display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
  #puzzleInstruction { 
    margin-bottom: 20px; 
    text-align: center; 
    font-size: clamp(14px, 4vw, 16px); 
    color: #d60000;
    font-weight: 600;
  }
  #cardGame {
    display: grid; 
    grid-template-columns: repeat(4, clamp(70px, 20vw, 90px));
    grid-template-rows: repeat(3, clamp(100px, 25vw, 120px)); 
    gap: 10px;
    margin-bottom: 20px;
    perspective: 1000px;
  }
  .memory-card {
    width: 100%; 
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    cursor: pointer;
    border-radius: 16px;
  }
  .memory-card.flipped {
    transform: rotateY(180deg);
  }
  .memory-card.matched {
    animation: matchPulse 0.6s ease;
  }
  @keyframes matchPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }
  .card-face {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    backface-visibility: hidden;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: clamp(32px, 8vw, 42px);
    box-shadow: 0 6px 20px rgba(214, 0, 0, 0.25);
  }
  .card-front {
    background: linear-gradient(135deg, #ff6fa5, #ff1a75);
    position: relative;
    overflow: hidden;
    transform: rotateY(0deg);
  }
  .card-front::before {
    content: 'üíù';
    position: absolute;
    font-size: clamp(40px, 10vw, 50px);
    opacity: 0.3;
    animation: floatHeart 3s ease-in-out infinite;
  }
  @keyframes floatHeart {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-10px) rotate(5deg); }
  }
  .card-back {
    background: white;
    transform: rotateY(180deg);
    border: 4px solid #ffd6e8;
    position: relative;
  }
  .card-back::after {
    content: '';
    position: absolute;
    inset: 8px;
    border-radius: 12px;
    background: linear-gradient(135deg, rgba(255, 182, 193, 0.1), rgba(255, 105, 180, 0.1));
  }
  #mergedReveal {
    display: none; justify-content: center; margin: 30px 0 20px;
  }
  #greyCard {
    width: clamp(250px, 80vw, 300px); 
    height: clamp(250px, 80vw, 300px);
    background: linear-gradient(135deg, #ffc0e0, #ffb3d9, #ff99cc);
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(255, 105, 180, 0.4);
    display: flex; align-items: center; justify-content: center;
    color: white; font-size: clamp(1.2em, 5vw, 1.4em); font-weight: bold;
    cursor: pointer; transition: all 0.6s ease;
    position: relative;
    overflow: hidden;
  }
  #greyCard::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
      45deg,
      transparent,
      rgba(255, 255, 255, 0.3),
      transparent
    );
    transform: rotate(45deg);
    animation: shimmer 3s infinite;
  }
  @keyframes shimmer {
    0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
    100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
  }
  #tapTextFinal { display: none; margin-top: 16px; color: #d60000; font-size: clamp(15px, 4vw, 17px); font-weight: 600; }
  #shortMessageFinal {
    display: none; margin: 16px 0;
    font-size: clamp(16px, 4vw, 18px); color: #d60000; font-weight: 600;
    text-align: center; max-width: 90%;
  }
  #nextAfterTap {
    display: none; padding: 12px 28px;
    font-size: clamp(16px, 4vw, 18px); background: #d60000; color: white;
    border: none; border-radius: 12px; cursor: pointer;
  }
  #nextAfterTap:hover { background: #ff1a1a; transform: scale(1.05); }
  
  /* Choice Page */
  #choicePage {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 20px;
  }
  #choicePage h1 {
    font-family: 'Fredoka One', cursive;
    color: #d60000;
    font-size: clamp(1.8em, 6vw, 2.5em);
    margin-bottom: 10px;
    text-align: center;
    width: auto;
    animation: none;
  }
  #choiceSubtext {
    font-size: clamp(14px, 4vw, 16px);
    color: #666;
    margin-bottom: 40px;
    text-align: center;
  }
  #choiceBoxes {
    display: flex;
    gap: 30px;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 700px;
  }
  .choiceBox {
    width: 280px;
    padding: 40px 30px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 3px solid transparent;
  }
  .choiceBox:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 50px rgba(214, 0, 0, 0.2);
    border-color: #ff6fa5;
  }
  .boxIcon {
    color: #ff6fa5;
    transition: all 0.3s ease;
  }
  .choiceBox:hover .boxIcon {
    transform: scale(1.1);
    color: #d60000;
  }
  .boxTitle {
    font-size: 24px;
    font-weight: 700;
    color: #d60000;
    font-family: 'Fredoka One', cursive;
  }
  .boxDesc {
    font-size: 14px;
    color: #666;
    text-align: center;
  }
  
  /* Floating Music Player - iOS Style */
  #musicPlayer {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-radius: 30px;
    padding: 12px 20px;
    display: flex;
    align-items: center;
    gap: 14px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
    z-index: 10000;
    border: 1px solid rgba(255, 255, 255, 0.4);
    min-width: 320px;
    opacity: 0;
    transition: all 0.3s ease;
  }
  #musicPlayer.show {
    opacity: 1;
  }
  #playHint {
    position: absolute;
    bottom: 100%;
    left: 20px;
    margin-bottom: 15px;
    background: linear-gradient(135deg, #ff6fa5, #d60000);
    color: white;
    padding: 10px 18px;
    border-radius: 15px;
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
    box-shadow: 0 4px 20px rgba(214, 0, 0, 0.3);
    display: none;
    pointer-events: none;
    z-index: 1;
  }
  #playHint.show {
    display: block;
    animation: hintFadeInOut 3s ease forwards;
  }
  #playHint::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 30px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid #d60000;
  }
  @keyframes hintFadeInOut {
    0% {
      opacity: 0;
      transform: translateY(10px);
    }
    10% {
      opacity: 1;
      transform: translateY(0);
    }
    90% {
      opacity: 1;
      transform: translateY(0);
    }
    100% {
      opacity: 0;
      transform: translateY(-5px);
    }
  }
  #musicProgress {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: rgba(255, 182, 193, 0.3);
    border-radius: 0 0 30px 30px;
    overflow: hidden;
  }
  #playPauseBtn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff6fa5, #d60000);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease;
    flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(214, 0, 0, 0.3);
  }
  #playPauseBtn:hover {
    transform: scale(1.1);
  }
  #playPauseBtn:active {
    transform: scale(0.95);
  }
  #songInfo {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
    min-width: 0;
  }
  #songTitle {
    font-size: 14px;
    font-weight: 600;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  #songArtist {
    font-size: 12px;
    color: #666;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  #progressBar {
    width: 80px;
    height: 6px;
    background: rgba(214, 0, 0, 0.2);
    border-radius: 10px;
    overflow: hidden;
    position: relative;
    cursor: pointer;
    flex-shrink: 0;
  }
  #progressFill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #ff6fa5, #d60000);
    border-radius: 10px;
    transition: width 0.1s linear;
  }

  /* Gallery Page */
  #galleryPage {
    display: none;
    flex-direction: column;
    width: 100%;
    min-height: 100vh;
    background: linear-gradient(135deg, #ffe6e6, #fff0f5);
    padding-bottom: 100px;
  }

  #galleryHeader {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-bottom: 1px solid rgba(255, 255, 255, 0.4);
    padding: 15px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    z-index: 1000;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
  }

  #galleryHeader button {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff6fa5, #d60000);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease;
    box-shadow: 0 4px 12px rgba(214, 0, 0, 0.3);
  }

  #galleryHeader button:hover {
    transform: scale(1.1);
  }

  #galleryTitle {
    text-align: center;
    flex: 1;
  }

  #galleryTitle h2 {
    font-family: 'Fredoka One', cursive;
    color: #d60000;
    font-size: 20px;
    margin: 0;
  }

  #photoCount {
    font-size: 12px;
    color: #666;
    font-weight: 500;
    margin-top: 2px;
  }

  #galleryGrid {
    margin-top: 90px;
    padding: 15px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 8px;
    max-width: 1200px;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  .gallery-item {
    position: relative;
    padding-bottom: 100%;
    overflow: hidden;
    border-radius: 12px;
    cursor: pointer;
    background: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  .gallery-item:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 20px rgba(214, 0, 0, 0.2);
    z-index: 10;
  }

  .gallery-item img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Slideshow Modal */
  #slideshowModal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.95);
    z-index: 10001;
    display: none;
    align-items: center;
    justify-content: center;
  }

  #slideshowModal.active {
    display: flex;
  }

  #closeSlideshow {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 10;
  }

  #closeSlideshow:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
  }

  .slideNav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 10;
  }

  .slideNav:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-50%) scale(1.1);
  }

  #prevSlide {
    left: 20px;
  }

  #nextSlide {
    right: 20px;
  }

  #slideshowImage {
    max-width: 90%;
    max-height: 80vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #slideshowImage img {
    max-width: 100%;
    max-height: 80vh;
    border-radius: 12px;
    box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
    animation: slideIn 0.4s ease;
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  #slideCounter {
    position: absolute;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    font-size: 16px;
    font-weight: 600;
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 20px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
  }

  #slideshowControls {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 15px;
  }

  #playPauseSlideshow {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff6fa5, #d60000);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease;
    box-shadow: 0 4px 12px rgba(214, 0, 0, 0.5);
  }

  #playPauseSlideshow:hover {
    transform: scale(1.1);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    #galleryGrid {
      grid-template-columns: repeat(3, 1fr);
      gap: 6px;
      padding: 10px;
    }

    #slideshowImage {
      max-width: 95%;
      max-height: 70vh;
    }

    .slideNav {
      width: 40px;
      height: 40px;
    }

    #prevSlide {
      left: 10px;
    }

    #nextSlide {
      right: 10px;
    }
  }

  /* Letter Page */
  #letterPage {
    display: none;
    flex-direction: column;
    width: 100%;
    min-height: 100vh;
    background: linear-gradient(135deg, #ffe6e6, #fff0f5);
    padding-bottom: 100px;
  }

  #letterHeader {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-bottom: 1px solid rgba(255, 255, 255, 0.4);
    padding: 15px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    z-index: 1000;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
  }

  #letterHeader button {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff6fa5, #d60000);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s ease;
    box-shadow: 0 4px 12px rgba(214, 0, 0, 0.3);
  }

  #letterHeader button:hover {
    transform: scale(1.1);
  }

  #letterTitle {
    text-align: center;
    flex: 1;
  }

  #letterTitle h2 {
    font-family: 'Fredoka One', cursive;
    color: #d60000;
    font-size: 20px;
    margin: 0;
  }

  #letterCount {
    font-size: 12px;
    color: #666;
    font-weight: 500;
    margin-top: 2px;
  }

  #letterSelection {
    margin-top: 120px;
    padding: 20px;
    display: flex;
    gap: 30px;
    justify-content: center;
    flex-wrap: wrap;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .letter-envelope {
    width: 280px;
    height: 200px;
    perspective: 1000px;
    cursor: pointer;
    transition: transform 0.3s ease;
  }

  .letter-envelope:hover {
    transform: translateY(-10px);
  }

  .envelope-front {
    width: 100%;
    height: 100%;
    background: white;
    border-radius: 8px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    border: 2px solid #ffd6e8;
  }

  .letter-envelope:hover .envelope-front {
    box-shadow: 0 15px 50px rgba(214, 0, 0, 0.25);
    border-color: #ff6fa5;
  }

  .envelope-flap {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 0;
    border-left: 140px solid transparent;
    border-right: 140px solid transparent;
    border-top: 80px solid #ff6fa5;
    transform-origin: top;
    transition: transform 0.6s ease;
  }

  .letter-envelope.opening .envelope-flap {
    transform: rotateX(-180deg);
  }

  .envelope-label {
    font-family: 'Fredoka One', cursive;
    font-size: 24px;
    color: #d60000;
    margin-top: 60px;
    z-index: 1;
  }

  .heart-seal {
    font-size: 40px;
    margin-top: 10px;
    animation: heartbeat 1.5s ease-in-out infinite;
  }

  @keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }

  /* Letter Content Modal */
  #letterContentModal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.9);
    z-index: 10002;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 20px;
    opacity: 0;
    transition: opacity 0.5s ease;
  }

  #letterContentModal.active {
    display: flex;
    opacity: 1;
  }

  #closeLetterContent {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 10;
  }

  #closeLetterContent:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
  }

  #letterPaper {
    max-width: 700px;
    width: 100%;
    max-height: 80vh;
    background: #ffffff;
    border-radius: 12px;
    padding: 50px 40px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow-y: auto;
    animation: letterUnfold 0.8s ease;
    background-image: 
      repeating-linear-gradient(
        transparent,
        transparent 30px,
        rgba(214, 0, 0, 0.05) 30px,
        rgba(214, 0, 0, 0.05) 31px
      );
  }

  @keyframes letterUnfold {
    0% {
      transform: scaleY(0.1) rotateX(-90deg);
      opacity: 0;
    }
    50% {
      transform: scaleY(0.5) rotateX(-45deg);
      opacity: 0.5;
    }
    100% {
      transform: scaleY(1) rotateX(0deg);
      opacity: 1;
    }
  }

  #letterPaper::before {
    content: '';
    position: absolute;
    top: 0;
    left: 40px;
    width: 2px;
    height: 100%;
    background: rgba(214, 0, 0, 0.15);
  }

  #letterMessage {
    font-family: 'Montserrat', sans-serif;
    font-size: 16px;
    line-height: 1.8;
    color: #333;
    white-space: pre-wrap;
    position: relative;
    z-index: 1;
  }

  @media (max-width: 768px) {
    #letterSelection {
      margin-top: 100px;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      padding: 10px;
      width: 100%;
    }

    .letter-envelope {
      width: 85%;
      max-width: 240px;
      height: 140px;
    }

    .envelope-flap {
      border-left: 120px solid transparent;
      border-right: 120px solid transparent;
      border-top: 56px solid #ff6fa5;
    }

    .envelope-label {
      font-size: 16px;
      margin-top: 40px;
    }

    .heart-seal {
      font-size: 28px;
      margin-top: 5px;
    }

    #letterPaper {
      padding: 25px 20px;
      max-height: 70vh;
      max-width: 90%;
      margin: 0 auto;
    }

    #letterPaper::before {
      left: 20px;
    }

    #letterMessage {
      font-size: 14px;
      line-height: 1.6;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    #closeLetterContent {
      top: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
    }
  }

</style>
</head>
<body>

<div id="loadingScreen">
  <div class="cat-wrapper">
    <img class="cat" src="https://media.giphy.com/media/JIX9t2j0ZTN9S/giphy.gif" alt="cat">
  </div>
  <div class="loading-text">This will take a few seconds</div>
  <div class="loading-text">Get ready...</div>
  <div class="countdown" id="countdown"></div>
</div>

<!-- Floating Music Player -->
<div id="musicPlayer">
  <div id="musicProgress"></div>
  <div id="playHint">üëÜ Play the music!</div>
  <button id="playPauseBtn">
    <svg id="playIcon" width="24" height="24" viewBox="0 0 24 24" fill="white">
      <path d="M8 5v14l11-7z"/>
    </svg>
    <svg id="pauseIcon" width="24" height="24" viewBox="0 0 24 24" fill="white" style="display:none;">
      <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
    </svg>
  </button>
  <div id="songInfo">
    <div id="songTitle">Nothing</div>
    <div id="songArtist">Bruno Major</div>
  </div>
  <div id="progressBar">
    <div id="progressFill"></div>
  </div>
</div>

<audio id="popSound" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>
<audio id="bgMusic" loop preload="auto"></audio>

<div class="container" id="mainContainer" style="display:none;">
  <div id="marqueeBanner">
    <div id="marqueeText">
      <span>PLEASE TYPE "YES" ‚ú® PLEASE TYPE "YES" ‚ú® PLEASE TYPE "YES" ‚ú® PLEASE TYPE "YES" ‚ú® PLEASE TYPE "YES" ‚ú® PLEASE TYPE "YES" ‚ú® PLEASE TYPE "YES" ‚ú® PLEASE TYPE "YES" ‚ú®</span>
    </div>
  </div>
  <h1>Will you be my Valentine?</h1>
  <div class="input-boxes">
    <div class="box" id="box1"></div>
    <div class="box" id="box2"></div>
    <div class="box" id="box3"></div>
  </div>
  <div class="keyboard" id="keyboard">
    <div class="row" id="row1"></div>
    <div class="row" id="row2"></div>
    <div class="row" id="row3"></div>
  </div>
  <div id="message"></div>
  <div id="shortMessage">Please wait a few seconds while we prepare a surprise for you...</div>
  <div id="loading">LOADING<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span> <span id="countdown8">8</span>s</div>
  <button id="proceedBtn">Proceed</button>
</div>

<div id="puzzleContainer">
  <h1>Match the Hearts! üíï</h1>
  <div id="puzzleInstruction">Find pairs to unlock our special moment ‚ú®</div>
  <div id="cardGame"></div>
  <div id="mergedReveal">
    <div id="greyCard">Tap me ‚ô•</div>
  </div>
  <div id="tapTextFinal">Tap the card ‚Üë</div>
  <div id="shortMessageFinal"></div>
  <button id="nextAfterTap">Next</button>
</div>

<div id="choicePage">
  <h1>Open a present</h1>
  <div id="choiceBoxes">
    <div class="choiceBox" id="galleryBox">
      <div class="boxIcon">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
          <circle cx="8.5" cy="8.5" r="1.5"/>
          <polyline points="21 15 16 10 5 21"/>
        </svg>
      </div>
      <div class="boxTitle">Gallery</div>
      <div class="boxDesc">Our memories together</div>
    </div>
    <div class="choiceBox" id="letterBox">
      <div class="boxIcon">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
          <polyline points="22,6 12,13 2,6"/>
        </svg>
      </div>
      <div class="boxTitle">Letter</div>
      <div class="boxDesc">A message for you</div>
    </div>
  </div>
</div>

<!-- Gallery Page -->
<div id="galleryPage">
  <div id="galleryHeader">
    <button id="backToChoice">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
    </button>
    <div id="galleryTitle">
      <h2>Our Memories</h2>
      <div id="photoCount">0 photos</div>
    </div>
    <button id="slideshowBtn">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <polygon points="5 3 19 12 5 21 5 3"/>
      </svg>
    </button>
  </div>
  
  <div id="galleryGrid"></div>
  
  <!-- Slideshow Modal -->
  <div id="slideshowModal">
    <button id="closeSlideshow">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
    
    <button id="prevSlide" class="slideNav">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    </button>
    
    <div id="slideshowImage"></div>
    
    <button id="nextSlide" class="slideNav">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3">
        <path d="M9 18l6-6-6-6"/>
      </svg>
    </button>
    
    <div id="slideCounter">1 / 22</div>
    
    <div id="slideshowControls">
      <button id="playPauseSlideshow">
        <svg id="playSlideIcon" width="20" height="20" viewBox="0 0 24 24" fill="white">
          <path d="M8 5v14l11-7z"/>
        </svg>
        <svg id="pauseSlideIcon" width="20" height="20" viewBox="0 0 24 24" fill="white" style="display:none;">
          <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<!-- Letter Page -->
<div id="letterPage">
  <div id="letterHeader">
    <button id="backToChoiceFromLetter">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
    </button>
    <div id="letterTitle">
      <h2>Love Letters</h2>
      <div id="letterCount">Choose a letter to open</div>
    </div>
  </div>

  <div id="letterSelection">
    <div class="letter-envelope" id="envelope1">
      <div class="envelope-front">
        <div class="envelope-flap"></div>
        <div class="envelope-label">Letter 1</div>
        <div class="heart-seal">üíï</div>
      </div>
    </div>
    <div class="letter-envelope" id="envelope2">
      <div class="envelope-front">
        <div class="envelope-flap"></div>
        <div class="envelope-label">Letter 2</div>
        <div class="heart-seal">üíï</div>
      </div>
    </div>
  </div>
</div>

<!-- Letter Content Modal -->
<div id="letterContentModal">
  <button id="closeLetterContent">
    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
      <line x1="18" y1="6" x2="6" y2="18"/>
      <line x1="6" y1="6" x2="18" y2="18"/>
    </svg>
  </button>
  
  <div id="letterPaper">
    <div id="letterMessage"></div>
  </div>
</div>

<script>
// Gallery Images - Add your image URLs here
const galleryImages = [
  './IMAGES/1.jpg',
  './IMAGES/2.jpg',
  './IMAGES/3.jpg',
  './IMAGES/4.jpg',
  './IMAGES/5.jpg',
  './IMAGES/6.jpg',
  './IMAGES/7.jpg',
  './IMAGES/8.jpg',
  './IMAGES/9.jpg',
  './IMAGES/10.jpg',
  './IMAGES/11.jpg',
  './IMAGES/12.jpg',
  './IMAGES/13.jpg',
  './IMAGES/14.jpg',
  './IMAGES/15.jpg',
  './IMAGES/16.jpg',
  './IMAGES/17.jpg',
  './IMAGES/18.jpg',
  './IMAGES/19.jpg',
  './IMAGES/20.jpg',
  './IMAGES/21.jpg',
  './IMAGES/22.jpg'
];

// Set up music source and volume
const bgMusic = document.getElementById("bgMusic");
bgMusic.src = "./IMAGES/music.mp3";
bgMusic.volume = 0.7;

// Debug music loading
bgMusic.addEventListener('loadeddata', () => console.log("‚úÖ Music file loaded successfully"));
bgMusic.addEventListener('error', (e) => console.error("‚ùå Music loading error:", e, "Check if ./IMAGES/music.mp3 exists"));
bgMusic.addEventListener('canplay', () => console.log("‚úÖ Music can play"));

// Music Player Controls
const playPauseBtn = document.getElementById('playPauseBtn');
const playIcon = document.getElementById('playIcon');
const pauseIcon = document.getElementById('pauseIcon');
const progressFill = document.getElementById('progressFill');
const progressBar = document.getElementById('progressBar');
let isPlaying = false;

// Play/Pause toggle
playPauseBtn.addEventListener('click', () => {
  if (isPlaying) {
    bgMusic.pause();
    playIcon.style.display = 'block';
    pauseIcon.style.display = 'none';
    isPlaying = false;
  } else {
    bgMusic.play()
      .then(() => {
        playIcon.style.display = 'none';
        pauseIcon.style.display = 'block';
        isPlaying = true;
        console.log("‚úÖ Music playing");
      })
      .catch(err => console.error("‚ùå Play error:", err));
  }
});

// Update progress bar
bgMusic.addEventListener('timeupdate', () => {
  if (bgMusic.duration) {
    const progress = (bgMusic.currentTime / bgMusic.duration) * 100;
    progressFill.style.width = progress + '%';
  }
});

// Click progress bar to seek
progressBar.addEventListener('click', (e) => {
  const rect = progressBar.getBoundingClientRect();
  const clickX = e.clientX - rect.left;
  const percentage = clickX / rect.width;
  bgMusic.currentTime = percentage * bgMusic.duration;
});

// Auto-play attempt when keyboard page loads
setTimeout(() => {
  if (document.getElementById("mainContainer").style.display === "flex") {
    bgMusic.play()
      .then(() => {
        playIcon.style.display = 'none';
        pauseIcon.style.display = 'block';
        isPlaying = true;
      })
      .catch(() => {
        // Autoplay blocked, user will need to click play button
        console.log("‚ö†Ô∏è Autoplay blocked - click play button to start music");
      });
  }
}, 3000);

// Loading animation
const loadingScreen = document.getElementById("loadingScreen");
const countdownEl = document.getElementById("countdown");
const pop = document.getElementById("popSound");
let count = 5;
setTimeout(() => {
  countdownEl.classList.add("show");
  countdownEl.innerText = "In " + count;
  pop.play();
  const interval = setInterval(() => {
    countdownEl.classList.remove("show");
    setTimeout(() => {
      count--;
      if (count > 0) {
        countdownEl.innerText = count;
        countdownEl.classList.add("show");
        pop.currentTime = 0; pop.play();
      } else {
        clearInterval(interval);
        
        // Heart explosion from bottom
        for (let i = 0; i < 30; i++) {
          setTimeout(() => {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.bottom = '0';
            heart.style.top = 'auto';
            heart.style.animationDelay = Math.random() * 0.3 + 's';
            loadingScreen.appendChild(heart);
            
            setTimeout(() => heart.remove(), 2000);
          }, i * 50);
        }
        
        setTimeout(() => {
          loadingScreen.style.opacity = "0";
          setTimeout(() => {
            loadingScreen.style.display = "none";
            document.getElementById("mainContainer").style.display = "flex";
            document.getElementById("marqueeBanner").style.display = "block";
            
            // Show music player with hint
            setTimeout(() => {
              const musicPlayer = document.getElementById('musicPlayer');
              musicPlayer.classList.add('show');
              
              // Show hint after player appears
              setTimeout(() => {
                const hint = document.getElementById('playHint');
                hint.classList.add('show');
              }, 400);
            }, 300);
          }, 800);
        }, 1500);
      }
    }, 300);
  }, 1000);
}, 1500);

// Keyboard input
const box1 = document.getElementById('box1');
const box2 = document.getElementById('box2');
const box3 = document.getElementById('box3');
const boxes = [box1, box2, box3];
const rows = {
  row1: ['Q','W','E','R','T','Y','U','I','O','P'],
  row2: ['A','S','D','F','G','H','J','K','L'],
  row3: ['-','Z','X','C','V','B','N','M','Del']
};
const clickable = ['Y','E','S'];
const special = ['N','O'];
const message = document.getElementById('message');
let input = [], specialPressed = { N: false, O: false };

function createRow(id, letters) {
  const row = document.getElementById(id);
  letters.forEach(letter => {
    const key = document.createElement("div");
    key.classList.add("key");
    key.textContent = letter;
    if (clickable.includes(letter)) {
      key.classList.add("highlight");
      key.onclick = () => handleInput(letter);
    } else if (special.includes(letter)) {
      key.classList.add("special");
      key.onclick = () => handleSpecial(letter);
    } else if (letter === "Del") {
      key.classList.add("special");
      key.onclick = deleteInput;
    }
    row.appendChild(key);
  });
}

function handleInput(letter) {
  if (input.length < 3) {
    input.push(letter);
    updateBoxes();
    checkInput();
    // Try to play music on user interaction
    const bgMusic = document.getElementById("bgMusic");
    if (bgMusic.paused) {
      bgMusic.play().catch(e => console.log("Music play failed:", e));
    }
  }
}

function handleSpecial(letter) {
  if (input.length < 3) {
    input.push(letter);
    specialPressed[letter] = true;
    updateBoxes();
    if (specialPressed.N && specialPressed.O) message.textContent = "PLEASE!! üôè";
  }
}

function deleteInput() {
  if (input.length > 0) {
    const removed = input.pop();
    if (special.includes(removed)) {
      specialPressed[removed] = false;
      message.textContent = "";
    }
    updateBoxes();
  }
}

function updateBoxes() {
  boxes.forEach((box, i) => {
    box.textContent = input[i] || "";
    box.style.backgroundColor = input[i] ? "#d60000" : "#fff";
  });
}

function checkInput() {
  if (input.join("") === "YES") {
    document.getElementById('keyboard').classList.add("hidden");
    document.getElementById('marqueeBanner').style.display = "none";
    document.getElementById('shortMessage').style.display = "block";
    document.getElementById('loading').style.display = "block";
    let c = 8;
    const interval = setInterval(() => {
      c--;
      document.getElementById('countdown8').textContent = c;
      if (c <= 0) {
        clearInterval(interval);
        document.getElementById('proceedBtn').style.display = "block";
      }
    }, 1000);
  }
}

createRow("row1", rows.row1);
createRow("row2", rows.row2);
createRow("row3", rows.row3);

document.getElementById('proceedBtn').onclick = () => {
  document.getElementById('mainContainer').style.display = "none";
  document.getElementById('puzzleContainer').style.display = "flex";
  initCardGame();
};

// Card Matching Game - Valentine's Theme
const cardEmojis = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíù', 'üíò'];
let flippedCards = [];
let matchedPairs = 0;
let canFlip = true;

function initCardGame() {
  const cardGame = document.getElementById('cardGame');
  const puzzleInstruction = document.getElementById('puzzleInstruction');
  cardGame.innerHTML = '';
  matchedPairs = 0;
  flippedCards = [];
  canFlip = true;
  
  // Create pairs and shuffle
  const cards = [...cardEmojis, ...cardEmojis].sort(() => Math.random() - 0.5);
  
  cards.forEach((emoji, index) => {
    const card = document.createElement('div');
    card.classList.add('memory-card');
    card.dataset.emoji = emoji;
    card.dataset.index = index;
    
    card.innerHTML = `
      <div class="card-face card-front"></div>
      <div class="card-face card-back">${emoji}</div>
    `;
    
    card.addEventListener('click', () => flipCard(card));
    cardGame.appendChild(card);
  });
}

function createHeartParticles(x, y) {
  for (let i = 0; i < 8; i++) {
    const heart = document.createElement('div');
    heart.textContent = 'üíñ';
    heart.style.position = 'fixed';
    heart.style.left = x + 'px';
    heart.style.top = y + 'px';
    heart.style.fontSize = '20px';
    heart.style.pointerEvents = 'none';
    heart.style.zIndex = '9999';
    heart.style.animation = 'floatAway 1s ease-out forwards';
    
    const angle = (Math.PI * 2 * i) / 8;
    const distance = 50 + Math.random() * 30;
    heart.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
    heart.style.setProperty('--ty', Math.sin(angle) * distance - 50 + 'px');
    
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 1000);
  }
}

// Add keyframe animation for particles
const style = document.createElement('style');
style.textContent = `
  @keyframes floatAway {
    0% {
      transform: translate(0, 0) scale(1);
      opacity: 1;
    }
    100% {
      transform: translate(var(--tx), var(--ty)) scale(0.5);
      opacity: 0;
    }
  }
`;
document.head.appendChild(style);

function flipCard(card) {
  if (!canFlip || card.classList.contains('flipped') || card.classList.contains('matched')) {
    return;
  }
  
  card.classList.add('flipped');
  flippedCards.push(card);
  
  if (flippedCards.length === 2) {
    canFlip = false;
    checkMatch();
  }
}

function checkMatch() {
  const [card1, card2] = flippedCards;
  const emoji1 = card1.dataset.emoji;
  const emoji2 = card2.dataset.emoji;
  
  if (emoji1 === emoji2) {
    // Match! Create heart particles
    const rect1 = card1.getBoundingClientRect();
    const rect2 = card2.getBoundingClientRect();
    createHeartParticles(rect1.left + rect1.width / 2, rect1.top + rect1.height / 2);
    createHeartParticles(rect2.left + rect2.width / 2, rect2.top + rect2.height / 2);
    
    card1.classList.add('matched');
    card2.classList.add('matched');
    matchedPairs++;
    flippedCards = [];
    canFlip = true;
    
    // Update instruction text with encouragement
    const messages = [
      "Great match! Keep going! üíï",
      "You're doing amazing! ‚ù§Ô∏è",
      "Perfect pair! Almost there! üíñ",
      "Wonderful! Just a few more! üíó",
      "So close! You've got this! üíù",
      "Last one! Finish strong! üíò"
    ];
    document.getElementById('puzzleInstruction').textContent = messages[matchedPairs - 1];
    
    if (matchedPairs === 6) {
      // All pairs matched!
      setTimeout(() => {
        document.getElementById('puzzleInstruction').textContent = "Perfect! You found them all! üéâüíï";
      }, 300);
      setTimeout(showReveal, 1200);
    }
  } else {
    // No match - flip back
    setTimeout(() => {
      card1.classList.remove('flipped');
      card2.classList.remove('flipped');
      flippedCards = [];
      canFlip = true;
    }, 1000);
  }
}

function showReveal() {
  const cardGame = document.getElementById('cardGame');
  const puzzleInstruction = document.getElementById('puzzleInstruction');
  
  // Fade out all cards
  const allCards = document.querySelectorAll('.memory-card');
  allCards.forEach((card, i) => {
    setTimeout(() => {
      card.style.transition = 'all 0.6s ease';
      card.style.transform = 'rotateY(180deg) scale(0)';
      card.style.opacity = '0';
    }, i * 100);
  });
  
  setTimeout(() => {
    cardGame.style.display = 'none';
    puzzleInstruction.style.display = 'none';
    document.getElementById('mergedReveal').style.display = 'flex';
    
    const card = document.getElementById('greyCard');
    card.style.opacity = '0';
    card.style.transform = 'scale(0.75)';
    
    setTimeout(() => {
      card.style.transition = 'all 0.9s ease';
      card.style.opacity = '1';
      card.style.transform = 'scale(1)';
      document.getElementById('tapTextFinal').style.display = 'block';
    }, 150);
  }, allCards.length * 100 + 600);
}

// Card tap
document.getElementById('greyCard').addEventListener('click', () => {
  const card = document.getElementById('greyCard');
  const tapText = document.getElementById('tapTextFinal');
  const nextBtn = document.getElementById('nextAfterTap');

  card.style.transition = 'all 0.7s ease';
  card.style.transform = 'scale(1.06)';
  card.style.background = 'linear-gradient(135deg, #ff6fa5, #d60000)';
  card.style.fontSize = '1.1em';
  card.style.padding = '20px';
  card.innerHTML = "You've made it this far‚Ä¶ now you get to choose what to open first. Click Next!";
  tapText.style.display = 'none';

  setTimeout(() => {
    nextBtn.style.display = 'inline-block';
  }, 800);
});

// Next button
document.getElementById('nextAfterTap').onclick = () => {
  document.getElementById('puzzleContainer').style.display = "none";
  document.getElementById('choicePage').style.display = "flex";
};

// Gallery Page Logic
let currentSlideIndex = 0;
let slideshowInterval = null;
let isSlideshowPlaying = false;

function initGallery() {
  const galleryGrid = document.getElementById('galleryGrid');
  const photoCount = document.getElementById('photoCount');
  
  galleryGrid.innerHTML = '';
  photoCount.textContent = `${galleryImages.length} photos`;
  
  galleryImages.forEach((imgSrc, index) => {
    const item = document.createElement('div');
    item.className = 'gallery-item';
    item.innerHTML = `<img src="${imgSrc}" alt="Memory ${index + 1}">`;
    item.addEventListener('click', () => openSlideshow(index));
    galleryGrid.appendChild(item);
  });
}

function openSlideshow(index) {
  currentSlideIndex = index;
  const modal = document.getElementById('slideshowModal');
  modal.classList.add('active');
  showSlide(currentSlideIndex);
}

function closeSlideshow() {
  const modal = document.getElementById('slideshowModal');
  modal.classList.remove('active');
  stopSlideshow();
}

function showSlide(index) {
  const slideshowImage = document.getElementById('slideshowImage');
  const slideCounter = document.getElementById('slideCounter');
  
  slideshowImage.innerHTML = `<img src="${galleryImages[index]}" alt="Slide ${index + 1}">`;
  slideCounter.textContent = `${index + 1} / ${galleryImages.length}`;
}

function nextSlide() {
  currentSlideIndex = (currentSlideIndex + 1) % galleryImages.length;
  showSlide(currentSlideIndex);
}

function prevSlide() {
  currentSlideIndex = (currentSlideIndex - 1 + galleryImages.length) % galleryImages.length;
  showSlide(currentSlideIndex);
}

function toggleSlideshow() {
  const playSlideIcon = document.getElementById('playSlideIcon');
  const pauseSlideIcon = document.getElementById('pauseSlideIcon');
  
  if (isSlideshowPlaying) {
    stopSlideshow();
  } else {
    startSlideshow();
  }
}

function startSlideshow() {
  isSlideshowPlaying = true;
  document.getElementById('playSlideIcon').style.display = 'none';
  document.getElementById('pauseSlideIcon').style.display = 'block';
  
  slideshowInterval = setInterval(() => {
    nextSlide();
  }, 3000);
}

function stopSlideshow() {
  isSlideshowPlaying = false;
  document.getElementById('playSlideIcon').style.display = 'block';
  document.getElementById('pauseSlideIcon').style.display = 'none';
  
  if (slideshowInterval) {
    clearInterval(slideshowInterval);
    slideshowInterval = null;
  }
}

// Gallery Event Listeners
document.getElementById('galleryBox').addEventListener('click', () => {
  document.getElementById('choicePage').style.display = 'none';
  document.getElementById('galleryPage').style.display = 'flex';
  document.getElementById('musicPlayer').classList.remove('show'); // Hide music player
  initGallery();
});

document.getElementById('backToChoice').addEventListener('click', () => {
  document.getElementById('galleryPage').style.display = 'none';
  document.getElementById('choicePage').style.display = 'flex';
  document.getElementById('musicPlayer').classList.add('show'); // Show music player again
});

document.getElementById('slideshowBtn').addEventListener('click', () => {
  openSlideshow(0);
  startSlideshow();
});

document.getElementById('closeSlideshow').addEventListener('click', closeSlideshow);
document.getElementById('nextSlide').addEventListener('click', nextSlide);
document.getElementById('prevSlide').addEventListener('click', prevSlide);
document.getElementById('playPauseSlideshow').addEventListener('click', toggleSlideshow);

// Keyboard navigation in slideshow
document.addEventListener('keydown', (e) => {
  const modal = document.getElementById('slideshowModal');
  if (modal.classList.contains('active')) {
    if (e.key === 'ArrowRight') nextSlide();
    if (e.key === 'ArrowLeft') prevSlide();
    if (e.key === 'Escape') closeSlideshow();
    if (e.key === ' ') {
      e.preventDefault();
      toggleSlideshow();
    }
  }
});

// Letter box (placeholder)
document.getElementById('letterBox').addEventListener('click', () => {
  document.getElementById('choicePage').style.display = 'none';
  document.getElementById('letterPage').style.display = 'flex';
  document.getElementById('musicPlayer').classList.remove('show'); // Hide music player
});

// Letter Page Logic
const letterMessages = {
  letter1: `Happy Valentine's Day baby! I don't know how many times I've said that I'm so lucky to have you, and I'll keep saying it a thousand more times because it's really true. Thank you for always supporting me and for always rooting for me. I'm always here for you too, no matter what.

I want you to see some of my favorite photos of us together. I love all the pictures we have, but these ones always make me remember the exact moments we shared and they make me smile every time hihi

I love you`,

  letter2: `See you on June baby! I'm really looking forward to our wedding! sheeeeesh apakaangas Asawa yarn? HAHAHAHAHA!

dee I'm really excited kasi after non mauumpisahan na natin lahat ng plano Excited na may halong pressure pero what i know is.. i'm really sure! kaso ikaw mukhang napilitan lang ata HAHAHAHAHAHAHA! pwede ba tusukin ng icepick yung judge pag di ka nag "opo"? chariizz.

De seryoso na, if you're not so sure baby, pwede mong sabihin agad sakin. I want to consider your decision and feelings. Wala ng atrasan yon shunga kaa. Dito lang me vale? Sabihan moko if there is something na bothered ka, pagusapan natin. Pero syempre may halong pilit gagawin ko HAHAHAHA!

haba na ng message taena gusto ko sana ipa-english kay chatgpt kaso feeling ko hindi ako yung nag sabi sayo  I hate too much formalityy!

Last na nga! Happy Valentine's Day ulit baby! I love you sososososmuchh!`
};

function openLetter(letterNumber) {
  const envelope = document.getElementById(`envelope${letterNumber}`);
  const modal = document.getElementById('letterContentModal');
  const letterMessage = document.getElementById('letterMessage');
  
  // Add opening animation to envelope
  envelope.classList.add('opening');
  
  // Wait for envelope animation then show letter content
  setTimeout(() => {
    letterMessage.textContent = letterMessages[`letter${letterNumber}`];
    modal.classList.add('active');
  }, 600);
}

function closeLetterContent() {
  const modal = document.getElementById('letterContentModal');
  modal.classList.remove('active');
  
  // Remove opening class from all envelopes
  document.querySelectorAll('.letter-envelope').forEach(env => {
    env.classList.remove('opening');
  });
}

// Letter envelope click handlers
document.getElementById('envelope1').addEventListener('click', () => openLetter(1));
document.getElementById('envelope2').addEventListener('click', () => openLetter(2));

// Close letter content
document.getElementById('closeLetterContent').addEventListener('click', closeLetterContent);

// Back to choice from letter page
document.getElementById('backToChoiceFromLetter').addEventListener('click', () => {
  document.getElementById('letterPage').style.display = 'none';
  document.getElementById('choicePage').style.display = 'flex';
  document.getElementById('musicPlayer').classList.add('show'); // Show music player again
});
</script>
</body>
</html>
